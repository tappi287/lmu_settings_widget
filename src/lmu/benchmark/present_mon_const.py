import ctypes
from ctypes import c_uint32, c_uint64, Structure

# Metrik-Konstanten aus PresentMonAPI.h
PM_METRIC_APPLICATION = 0
PM_METRIC_CPU_FRAME_TIME = 8
PM_METRIC_CPU_BUSY = 9
PM_METRIC_CPU_WAIT = 10
PM_METRIC_DISPLAYED_FPS = 11
PM_METRIC_PRESENTED_FPS = 12
PM_METRIC_GPU_TIME = 13
PM_METRIC_GPU_BUSY = 14
PM_METRIC_DISPLAY_LATENCY = 24
PM_METRIC_CLICK_TO_PHOTON_LATENCY = 25
PM_METRIC_GPU_POWER = 27
PM_METRIC_GPU_UTILIZATION = 32
PM_METRIC_CPU_UTILIZATION = 58
PM_METRIC_CPU_FREQUENCY = 62
PM_METRIC_CPU_CORE_UTILITY = 63
PM_METRIC_DISPLAYED_TIME = 17

# Stat-Konstanten aus PresentMonAPI.h
PM_STAT_NONE = 0
PM_STAT_AVG = 1
PM_STAT_PERCENTILE_99 = 2
PM_STAT_PERCENTILE_95 = 3
PM_STAT_PERCENTILE_90 = 4
PM_STAT_PERCENTILE_01 = 5
PM_STAT_MAX = 8
PM_STAT_MIN = 9
PM_STAT_MID_POINT = 10
PM_STAT_NON_ZERO_AVG = 15


class PM_QUERY_ELEMENT(Structure):
    """
    Spiegelt die PM_QUERY_ELEMENT-Struktur aus PresentMonAPI.h wider.
    """

    _fields_ = [
        ("metric", c_uint32),
        ("stat", c_uint32),
        ("deviceId", c_uint32),
        ("arrayIndex", c_uint32),
        ("dataOffset", c_uint64),
        ("dataSize", c_uint64),
    ]


class PM_VERSION(Structure):
    _fields_ = [
        ("major", c_uint32),
        ("minor", c_uint32),
        ("patch", c_uint32),
        ("tag", ctypes.c_char * 22),
        ("hash", ctypes.c_char * 8),
        ("config", ctypes.c_char * 4),
    ]


# enum PM_STATUS
PM_STATUS_SUCCESS = 0
PM_STATUS_FAILURE = 1
PM_STATUS_BAD_ARGUMENT = 2
PM_STATUS_BAD_HANDLE = 3
PM_STATUS_SERVICE_ERROR = 4
PM_STATUS_INVALID_ETL_FILE = 5
PM_STATUS_INVALID_PID = 6
PM_STATUS_ALREADY_TRACKING_PROCESS = 7
PM_STATUS_UNABLE_TO_CREATE_NSM = 8
PM_STATUS_INVALID_ADAPTER_ID = 9
PM_STATUS_OUT_OF_RANGE = 10
PM_STATUS_INSUFFICIENT_BUFFER = 11
PM_STATUS_PIPE_ERROR = 12
PM_STATUS_SESSION_NOT_OPEN = 13
PM_STATUS_MIDDLEWARE_MISSING_PATH = 14
PM_STATUS_NONEXISTENT_FILE_PATH = 15
PM_STATUS_MIDDLEWARE_INVALID_SIGNATURE = 16
PM_STATUS_MIDDLEWARE_MISSING_ENDPOINT = 17
PM_STATUS_MIDDLEWARE_VERSION_LOW = 18
PM_STATUS_MIDDLEWARE_VERSION_HIGH = 19
PM_STATUS_MIDDLEWARE_SERVICE_MISMATCH = 20
